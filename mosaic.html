<!-- Wide Horizontal Elliptical Orbit with Global Pause on Hover -->
<div id="deptOrbitWide1" class="orbit-wide-widget" role="group" aria-label="Department overview orbiting tiles">
  <div class="center-text">What does my Department Do</div>
  <!-- Hover description card -->
  <div class="hover-card" hidden></div>
  <!-- Tiles are injected by JS -->
</div>

<style>
  /* ---------- CONFIG DEFAULTS (JS overrides at runtime) ---------- */
  #deptOrbitWide1 {
    --size: 720px;   /* widget design dimension (square) */
    --tile: 128px;   /* circle diameter (bigger) */
    --bg: transparent;
  }

  /* ---------- LAYOUT ---------- */
  .orbit-wide-widget {
    width: min(96vw, var(--size));
    aspect-ratio: 1 / 1;
    position: relative;
    margin-inline: auto;
    background: var(--bg);
    overflow: hidden;
    isolation: isolate;
  }

  .center-text {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    color: #0f172a;
    font-weight: 800;
    line-height: 1.25;
    font-size: clamp(18px, 2.6vw, 32px);
    padding: .5rem .9rem;
    border-radius: 12px;
    background: color-mix(in srgb, white 88%, transparent);
    box-shadow: 0 2px 12px rgba(0,0,0,.08);
    pointer-events: none;
    user-select: none;
  }

  .tile {
    position: absolute;
    top: 0; left: 0;
    width: var(--tile);
    height: var(--tile);
    transform: translate(0,0);
    will-change: transform;
    pointer-events: auto; /* needed for hover/focus */
  }

  .tile-link {
    display: block;
    width: 100%; height: 100%;
    border-radius: 50%;
    overflow: hidden;
    border: 2px solid #fff;
    box-shadow: 0 8px 24px rgba(0,0,0,.18);
    background: #e9ecef;
    transition: transform .22s ease, box-shadow .22s ease;
    outline-offset: 3px;
  }

  .tile-link:hover,
  .tile-link:focus-visible {
    transform: scale(1.08);
    box-shadow: 0 14px 36px rgba(0,0,0,.28);
  }

  .tile-link img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  /* Hover description card */
  .hover-card {
    position: absolute;
    max-width: 280px;
    background: #ffffff;
    color: #0f172a;
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0,0,0,.18);
    padding: .7rem .85rem;
    font: 500 14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
    z-index: 5;
    pointer-events: none; /* so hovering card keeps the tile hovered */
  }
  .hover-card .title {
    font-weight: 800;
    margin-bottom: .25rem;
    font-size: 14px;
  }
  .hover-card .desc {
    font-weight: 500;
    opacity: .85;
    font-size: 13px;
  }

  @media (prefers-reduced-motion: reduce) {
    .tile-link { transition: none; }
  }
</style>

<script>
  /************************************************************
   * EDIT THIS CONFIG ONLY â€” easy ðŸ‘
   ************************************************************/
  const deptOrbitConfig1 = {
    sizePx: 720,            // bigger overall widget
    tileSizePx: 128,        // bigger circles
    centerText: "What does my Department Do",

    // Ellipse: wide horizontal orbit
    semiMajorPx: null,      // a (horizontal radius). null = auto to near edges
    ellipseVerticalFactor: 0.55, // b â‰ˆ a * factor (keeps a horizontal look)
    centerGapPx: 150,       // extra vertical clearance from center text (b >= tileR + centerGap)

    // Motion
    secondsPerOrbit: 26,    // lower = faster
    direction: 'clockwise', // 'clockwise' | 'counter'
    boundaryPaddingPx: 16,  // keep a bit of space from edges

    openInNewTab: true,

    // ðŸ‘‰ Replace these with your departments (label + desc + link + image)
    items: [
      { label: "IT Support",       desc: "Service desk, endpoint builds, user access, ticket triage.", href: "#", img: "https://picsum.photos/seed/it/600" },
      { label: "Infrastructure",   desc: "Networks, servers, cloud infra, backups, monitoring.",       href: "#", img: "https://picsum.photos/seed/infra/600" },
      { label: "Security",         desc: "Policies, audits, awareness, vulnerability & threat mgmt.", href: "#", img: "https://picsum.photos/seed/sec/600" },
      { label: "Finance",          desc: "Budgets, AP/AR, payroll, reporting, procurement controls.", href: "#", img: "https://picsum.photos/seed/fin/600" },
      { label: "HR",               desc: "Hiring, onboarding, training, benefits, culture & growth.", href: "#", img: "https://picsum.photos/seed/hr/600" },
      { label: "Operations",       desc: "Processes, logistics, facilities & continuous improvement.", href: "#", img: "https://picsum.photos/seed/ops/600" },
      { label: "Marketing",        desc: "Brand, campaigns, content, analytics & digital channels.",   href: "#", img: "https://picsum.photos/seed/mkt/600" },
      { label: "Sales",            desc: "Pipeline, accounts, proposals, CRM & revenue growth.",       href: "#", img: "https://picsum.photos/seed/sales/600" },
      { label: "Legal",            desc: "Contracts, compliance, privacy & risk management.",          href: "#", img: "https://picsum.photos/seed/legal/600" },
      { label: "R&D",              desc: "New products, prototyping, testing & innovation.",           href: "#", img: "https://picsum.photos/seed/rd/600" },
    ],
  };

  /************************************************************
   * RUNTIME (no edits needed below)
   ************************************************************/
  (function initDeptOrbit(rootId, cfg) {
    const TAU = Math.PI * 2;
    const root = document.getElementById(rootId);

    // Apply CSS vars
    root.style.setProperty('--size', cfg.sizePx + 'px');
    root.style.setProperty('--tile', cfg.tileSizePx + 'px');

    // Center text
    const centerEl = root.querySelector('.center-text');
    if (centerEl) centerEl.textContent = cfg.centerText || '';

    // Compute geometry
    const tileR = cfg.tileSizePx / 2;
    const cx = cfg.sizePx / 2;
    const cy = cfg.sizePx / 2;

    // a (semi-major, horizontal) â€” auto to near edges if null
    const aMax = Math.min(cx, cy) - tileR - cfg.boundaryPaddingPx;
    const a = Math.min(aMax, (cfg.semiMajorPx ?? aMax));

    // b (semi-minor, vertical) â€” wide but keeps clear of center text and edges
    const bAutoMax = cy - tileR - cfg.boundaryPaddingPx;
    const bCandidate = a * (cfg.ellipseVerticalFactor ?? 0.55);
    const bMin = tileR + Math.max(0, cfg.centerGapPx);
    const b = Math.max(bMin, Math.min(bAutoMax, bCandidate));

    // Build tiles
    root.querySelectorAll('.tile').forEach(n => n.remove());
    const N = cfg.items.length;
    const dirSign = (cfg.direction === 'counter') ? 1 : -1;
    const omega = TAU / cfg.secondsPerOrbit * dirSign; // rad/s

    const states = []; // {el, theta, label, desc, href}
    cfg.items.forEach((item, i) => {
      const tile = document.createElement('div');
      tile.className = 'tile';

      const aEl = document.createElement('a');
      aEl.className = 'tile-link';
      aEl.href = item.href || '#';
      aEl.setAttribute('aria-label', item.label || 'Tile');
      aEl.title = item.label || '';
      if (cfg.openInNewTab) { aEl.target = '_blank'; aEl.rel = 'noopener'; }

      const img = document.createElement('img');
      img.src = item.img || '';
      img.alt = item.label || '';
      img.loading = 'lazy';

      aEl.appendChild(img);
      tile.appendChild(aEl);
      root.appendChild(tile);

      const theta0 = (TAU / N) * i;
      states.push({ el: tile, theta: theta0, label: item.label || '', desc: item.desc || '', href: item.href || '#' });
    });

    // Hover/Focus: freeze ALL and show description near the hovered tile
    const hoverCard = root.querySelector('.hover-card');
    let pausedAll = false;
    let hoveredIndex = -1;

    function showCardAt(idx, px, py, scale) {
      if (!hoverCard) return;
      const s = states[idx];
      hoverCard.innerHTML = `<div class="title">${s.label}</div><div class="desc">${s.desc || ""}</div>`;
      // Position above and slightly to the right of the tile
      const offset = (tileR + 12) * scale;
      let cardX = px + offset;
      let cardY = py - offset;
      // Keep within container bounds
      const cw = hoverCard.offsetWidth || 260;
      const ch = hoverCard.offsetHeight || 90;
      const maxX = root.clientWidth - cw - 8;
      const maxY = root.clientHeight - ch - 8;
      cardX = Math.max(8, Math.min(maxX, cardX));
      cardY = Math.max(8, Math.min(maxY, cardY));
      hoverCard.style.transform = `translate(${cardX}px, ${cardY}px)`;
      hoverCard.hidden = false;
    }

    function hideCard() {
      if (hoverCard) hoverCard.hidden = true;
    }

    states.forEach((s, idx) => {
      const enter = () => { pausedAll = true; hoveredIndex = idx; };
      const leave = () => { pausedAll = false; hoveredIndex = -1; hideCard(); };
      s.el.addEventListener('mouseenter', enter);
      s.el.addEventListener('mouseleave', leave);
      s.el.addEventListener('focusin', enter);
      s.el.addEventListener('focusout', leave);

      // Touch: pause & show card while pressed
      s.el.addEventListener('pointerdown', enter);
      s.el.addEventListener('pointerup', leave);
      s.el.addEventListener('pointercancel', leave);
      s.el.addEventListener('pointerleave', leave);
    });

    // Animation loop
    let last = performance.now();
    function frame(now) {
      requestAnimationFrame(frame);
      const dt = Math.min(0.04, (now - last) / 1000);
      last = now;

      const scale = root.clientWidth / cfg.sizePx;

      states.forEach((s, idx) => {
        if (!pausedAll) {
          s.theta += omega * dt;
          if (s.theta > TAU) s.theta -= TAU;
          if (s.theta < 0) s.theta += TAU;
        }

        // Ellipse parametric position
        const x = cx + a * Math.cos(s.theta);
        const y = cy + b * Math.sin(s.theta);

        // Convert to pixel space and center the tile
        const px = x * scale - tileR * scale;
        const py = y * scale - tileR * scale;
        s.el.style.transform = `translate(${px}px, ${py}px)`;

        // If currently hovered, place the hover card near this tile
        if (idx === hoveredIndex) {
          showCardAt(idx, px, py, scale);
        }
      });
    }

    requestAnimationFrame(frame);
  })('deptOrbitWide1', deptOrbitConfig1);
</script>
``
